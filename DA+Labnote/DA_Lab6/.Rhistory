knitr::opts_chunk$set(echo = TRUE)
library('tidyverse')
library(mdsr)
library(olsrr)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
HELPrct
?mdsr
library(mdsr)
mdsr
?mdsr
??mdsr
?HELPrct
HELPrct
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
df_exs <- data(HELPrct) %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
HELPrct
?HELPrct
library(tidyverse)
library(mdsr)
library(olsrr)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
data(HELPrct)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
install.packages('olsrr')
install.packages("olsrr")
library(mosaicData)
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
libaray(modaicdata)
library(modaicdata)
library(modaicdata)#to load HELPrct
library(mosaicdata)#to load HELPrct
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
library(mosaicData)#to load HELPrct
df_exs <- HELPrct %>%
select(id, cesd, age, female, avg_drinks, dayslink, drugrisk, mcs, pcs, pss_fr, racegrp, treat)
levels(df_exs$racegrp)
levels(df_exs$treat)
exs_one_hot <- model.matrix(~0+df_exs$racegrp)
df_temp <- df_exs %>%
cbind(exs_one_hot) %>%
mutate(istreat = ifelse(treat == 'yes', 1, 0)) %>%
rename('isBlack' = 'df_exs$racegrpblack', 'isHisph' = 'df_exs$racegrphispanic', 'isOther' = 'df_exs$racegrpother', 'isWhite' = 'df_exs$racegrpwhite') %>%
select(-racegrp, -treat)
sum(is.na(df_temp$dayslink))
sum(is.na(df_temp$drugrisk))
temp_mean <- mean(df_temp$dayslink, na.rm = TRUE)
temp_mean2 <- mean(df_temp$drugrisk, na.rm = TRUE)
df_exs2 <- df_temp %>%
mutate(dayslink = ifelse(is.na(dayslink), temp_mean, dayslink), drugrisk = ifelse(is.na(drugrisk), temp_mean2, drugrisk))
sum(is.na(df_exs2$dayslink))
sum(is.na(df_exs2$drugrisk))
model_q3 <- lm(cesd ~ ., data = df_exs2 %>% select(-id, -isOther))
summary(model_q3)
m_both <- ols_step_both_aic(model_q3)
m_both$predictors
m_for <- ols_step_forward_aic(model_q3)
m_for$predictors
m_back <- ols_step_backward_aic(model_q3)
m_back$predictors
?HELPrct
plot(m_both, which = 1)
plot(m_both, which = 2)
plot(m_both, which = 3)
View(m_both)
plot(m_both, which = 1)
plot(m_both, which = 2)
plot(m_both, which = 15)
plot(m_both)
model_q3 <- lm(cesd ~ m_both$predictors, data = df_exs2)
m_both <- ols_step_both_aic(model_q3)
model_q3 <- lm(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2)
model_q4 <- lm(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2)
model_q3 <- lm(cesd ~ ., data = df_exs2 %>% select(-id, -isOther))
summary(model_q3)
m_both <- ols_step_both_aic(model_q3)
model_q4 <- lm(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2)
plot(model_q4, which = 1)
plot(model_q4, which = 2)
library(lmtest)
install.packages(lmtest)
install.packages('lmtest')
library(lmtest)
dwtest(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2, alternative = "two_sided")
dwtest(cesd ~ mcs + pcs + avg_drinks + female + pss_fr + isBlack, data = df_exs2, alternative = "two.sided")
model_q6 <- lm(cesd ~ mcs + pcs, data = df_exs2)
summary(model_q6)
model_q6a <- lm(cesd ~ mcs + pcs, data = df_exs2)
model_q6b <- lm(cesd ~ mcs + pcs + mcs*pcs, data = df_exs2)
summary(model_q6a)
summary(model_q6b)
model_q6b <- lm(cesd ~ mcs + pcs + mcs*pcs, data = df_exs2)
summary(model_q6a)
summary(model_q6b)
model_q6a <- lm(cesd ~ mcs + pcs, data = df_exs2)
model_q6b <- lm(cesd ~ mcs + pcs + mcs*pcs, data = df_exs2)
summary(model_q6a)
summary(model_q6b)
model_q7 <- lm(cesd ~ mcs, data = df_exs2)
summary(model_q7)
?lm
model_q6a <- lm(cesd ~ mcs + pcs, data = df_exs2)
model_q6b <- lm(cesd ~ mcs*pcs, data = df_exs2)
summary(model_q6a)
summary(model_q6b)
model_q7 <- lm(cesd ~ mcs, data = df_exs2)
summary(model_q7)
install.packages('glmnet')
library(glmnet)
glmnet(mcs, cesd)
glmnet(mcs, cesd, data = df_exs2)
glmnet(mcs, cesd, data = df_exs2)
glmnet(df_exs2$mcs, df_exs2$cesd)
knitr::opts_chunk$set(echo = TRUE)
library('tidyverse')
library('mosaicData')
library('mdsr')
qnorm(0.995)
round(qnorm(0.995), 2)
dfq2 <- Gestation %>% filter(is.na(age) == FALSE)
q2_mean <- mean(dfq2$age)
q2_sd <- sd(dfq2$age)
CI_q2 <- c(q2_mean - 2*q2_sd, q2_mean + 2*q2_sd)
CI_q2
q3_median <- median(dfq2$age)
q3_median
n_trial <- 200
dfq2_booted <- 1:n_trial %>%
map_dfr(
~dfq2 %>%
slice_sample(n = 100, replace = TRUE) %>%
summarise(median(age))
) %>% mutate(n = 100)
q3_med <- mean(dfq2_booted$`median(age)`)
q3_sd <- sd(dfq2_booted$`median(age)`)
CI_q3 <- c(q3_med - 2*q3_sd, q3_med + 2*q3_sd)
CI_q3
dfq4_bootstrap <- tibble()
for (i in 1:200) {
dfq4_temp <- slice_sample(dfq2, n = 100, replace = TRUE)
lmq4_temp <- lm(wt ~ age, data = dfq4_temp)
dfq4_bootstrap <- rbind(dfq4_bootstrap, coef(lmq4_temp))
}
colnames(dfq4_bootstrap) <- c('intercept', 'age')
dfq4_bootstrap
Macbeth <- Macbeth_raw %>%
str_split('\r\n') %>%
pluck(1)
Macbeth %>%
str_subset('^  [A-Z]+,')
Macbeth %>%
str_subset('[A-z]+-[A-z]+') %>%
str_extract('[A-z]+-[A-z]+')
strings <- c(
"This string has no hashtags",
"#hashtag city!",
"This string has a #hashtag",
"This string has #two #hashtags"
)
str_detect(strings, '(^| )#[A-z0-9]+( |$)')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
library(mosaicData)#to load HELPrct
library(lmtest)
library(glmnet)
library(glmnet)
install.packages('glmnet')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
library(mosaicData)#to load HELPrct
library(lmtest)
library(glmnet)
library(mosaicData)#to load HELPrct
library(lmtest)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
library(lmtest)
library(glmnet)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
library(lmtest)
library(glmnet)
dfq4_bootstrap <- tibble()
for (i in 1:200) {
dfq4_temp <- slice_sample(dfq2, n = 100, replace = TRUE)
lmq4_temp <- lm(wt ~ age, data = dfq4_temp)
dfq4_bootstrap <- rbind(dfq4_bootstrap, coef(lmq4_temp))
}
library('tidyverse')
library('mosaicData')
library('mdsr')
knitr::opts_chunk$set(echo = TRUE)
library('tidyverse')
library('mosaicData')
library('mdsr')
# Problem 1
```{r}
qnorm(0.995)
round(qnorm(0.995), 2)
qnorm(0.995)
round(qnorm(0.995), 2)
95% CI를 위해 사용되는 Z_0.495의 근사치는 2(or 1.96)이다. 99% CI를 위해 사용되어야 하는 근사치는 확률변수 Z가 표준정규분포 N(0,1)을 따를 때 P(Z < a) = 1 - (1 - 0.99)/2가 되도록 하는 a의 값이다. 이 값은 R에서는 `qnorm(1 - (1 - 0.99)/2)`함수를 통해 앞의 코드와 같이 구할 수 있으며, 이 값을 소수점 아래 셋째 자리에서 반올림하면 2.58을 근사치로 사용할 수 있다.
# Problem 2
```{r}
dfq2 <- Gestation %>% filter(is.na(age) == FALSE)
q2_sd <- sd(dfq2$age)
CI_q2 <- c(q2_mean - 2*q2_sd, q2_mean + 2*q2_sd)
CI_q2
dfq2 <- Gestation %>% filter(is.na(age) == FALSE)
q2_mean <- mean(dfq2$age)
q2_sd <- sd(dfq2$age)
CI_q2 <- c(q2_mean - 2*q2_sd, q2_mean + 2*q2_sd)
CI_q2
# Problem 3
```{r}
q3_median <- median(dfq2$age)
q3_median
n_trial <- 200
dfq2_booted <- 1:n_trial %>%
map_dfr(
~dfq2 %>%
slice_sample(n = 100, replace = TRUE) %>%
summarise(median(age))
) %>% mutate(n = 100)
dfq2_booted <- 1:n_trial %>%
map_dfr(
~dfq2 %>%
slice_sample(n = 100, replace = TRUE) %>%
summarise(median(age))
) %>% mutate(n = 100)
q3_med <- mean(dfq2_booted$`median(age)`)
q3_sd <- sd(dfq2_booted$`median(age)`)
CI_q3 <- c(q3_med - 2*q3_sd, q3_med + 2*q3_sd)
CI_q3
dfq4_bootstrap <- tibble()
for (i in 1:200) {
dfq4_temp <- slice_sample(dfq2, n = 100, replace = TRUE)
lmq4_temp <- lm(wt ~ age, data = dfq4_temp)
dfq4_bootstrap <- rbind(dfq4_bootstrap, coef(lmq4_temp))
}
View(dfq4_bootstrap)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
library(lmtest)
library(glmnet)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(mdsr)
library(olsrr)
library(lmtest)
library(glmnet)
remove.packages('glmnet')
install.packages('glmnet')
quit()
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(tidyverse)
typeof(data$group)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(tidyverse)
data = read.csv('akc.csv')
hist(data$min_height)
ht = na.omit(data$min_height)
hist(ht)
hist(log(ht))
cut_ht = cut(ht, breaks = c(0,30,45,60,80))
table(cut_ht)
typeof(data$group)
typeof(factor(data$group))
data$group
factor(data$group)
factor(data$group)
data$group
data$group[1]
factor(data$group)[1]
?model.matrix
model.matrix(~1 + data$group)
head(model.matrix(~1 + data$group))
one_hot = model.matrix(~0+data$group)
head(one_hot)
one_hot = model.matrix(~0 + data$group)
head(model.matrix(~1 + data$group))
head(model.matrix(~x + data$group))
print(one_hot)
#head(model.matrix(~1 + data$group))
#print(model.matrix(~1+data$group))
```
#head(model.matrix(~1 + data$group))
print(model.matrix(~1+data$group))
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
affairs_df <- read_csv('affairs.csv')
affairs_df %>%
pull(affairs) %>%
table()
library(magrittr)
affairs_df %<>% mutate(cheater = affairs > 0)
affairs_m <- glm(cheater ~ gender + rating,
family = binomial(link = 'logit'),
data = affairs_df)
summary(affairs_m)
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
BP_narrow %>% pivot_wider(names_from = when, values_from = sbp)
knitr::include_graphics("wider.png")
library(tidyverse)
BP_narrow <- tribble(
~subject, ~when, ~sbp,
"BHO", "before", 160,
"GWB", "before", 120,
"WJC", "before", 105,
"BHO", "after", 115,
"GWB", "after", 135,
"WJC", "after", 145
)
BP_wide <- BP_narrow %>% pivot_wider(names_from = "when", values_from = "sbp")
BP_new<-BP_wide %>% mutate(change = after - before)
library(lubridate)
BP_full<-tribble(
~subject, ~when, ~sbp,
"BHO", "before", 160,
"GWB", "before", 120,
"BHO", "before", 155,
"WJC", "after", 145,
"WJC", "after", NA,
"WJC", "after", 130,
"GWB", "after", 135,
"WJC", "before", 105,
"BHO", "after", 115) %>% add_column(dbp=c(69,54,65,75,65,60,NA,60,78)) %>% add_column(date=ymd("2007-06-19","1998-04-21","2005-11-08","2002-11-15","2010-03-26","2013-09-15","2009-05-08","1990-08-17","2017-06-04"))
BP_narrow %>% pivot_wider(names_from = when, values_from = sbp)
library(tidyverse)
BP_narrow <- tribble(
~subject, ~when, ~sbp,
"BHO", "before", 160,
"GWB", "before", 120,
"WJC", "before", 105,
"BHO", "after", 115,
"GWB", "after", 135,
"WJC", "after", 145
)
BP_wide <- BP_narrow %>% pivot_wider(names_from = "when", values_from = "sbp")
BP_new<-BP_wide %>% mutate(change = after - before)
library(lubridate)
BP_full<-tribble(
~subject, ~when, ~sbp,
"BHO", "before", 160,
"GWB", "before", 120,
"BHO", "before", 155,
"WJC", "after", 145,
"WJC", "after", NA,
"WJC", "after", 130,
"GWB", "after", 135,
"WJC", "before", 105,
"BHO", "after", 115) %>% add_column(dbp=c(69,54,65,75,65,60,NA,60,78)) %>% add_column(date=ymd("2007-06-19","1998-04-21","2005-11-08","2002-11-15","2010-03-26","2013-09-15","2009-05-08","1990-08-17","2017-06-04"))
View(BP_narrow)
