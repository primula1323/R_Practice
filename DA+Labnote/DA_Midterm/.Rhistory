knitr::opts_chunk$set(echo = TRUE)
library(tidymodels)#model learning
library(boot)
library(splines)#Splines
library(pscl)# zero-inflated models
library(ggcorrplot)# for corrplot
library(e1071)#naive bayse
library(MASS)#lda, qda
library(tidyverse)
library(leaps)#linear model selection
library(gam)
library(glmnet)
df7_train <- read.csv("./dataset/dataset7_train.csv")
df7_test <- read.csv("./dataset/dataset7_test.csv")
df7_train
summary(df7_train$y)
mean(df7_train$y)
var(df7_train$y)
poisson_df7_full <- glm(y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10, data = df7_train, family = 'poisson')
summary(poisson_df7_full)
cv.err <- cv.glm(df7_train[,-1], poisson_df7_full)
cv.err$delta
pairs(~x2 + x5 + x7 + x9 + x10 + y, data = trn1)
df3_train <- read.csv("./dataset/dataset3_train.csv")
df3_test <- read.csv("./dataset/dataset3_test.csv")
df3_train
summary(df3_train)
set.seed(42)
data_split_df3 <- initial_split(df3_train, prop = 0.9)
trn3 <- training(data_split_df3)
tst3 <- testing(data_split_df3)
best_select_df3 <- regsubsets(y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10, data = trn3, nvmax = 10)
sum_lm3 <- summary(best_select_df3)
which.min(sum_lm3$cp)
which.min(sum_lm3$bic)
which.min(sum_lm3$adjr2)
coef(regsubsets(y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10, data = trn3, nvmax = 10), id = 1)
coef(regsubsets(y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10, data = trn3, nvmax = 10), id = 2)
ggcorrplot(cor(trn3), lab = T, lab_size = 2)
pairs(~x6 + x10 + y, data = trn3)
pairs(~., data = trn3)
pairs(~., data = df3_train)
hist(y)
hist(df3_train$y)
df3_train <- read.csv("./dataset/dataset3_train.csv")
df3_test <- read.csv("./dataset/dataset3_test.csv")
df3_train
summary(df3_train)
pairs(~., data = df3_train)
hist(df3_train$y)
set.seed(42)
data_split_df3 <- initial_split(df3_train, prop = 0.9)
trn3 <- training(data_split_df3)
tst3 <- testing(data_split_df3)
lm1_df3 <-
linear_reg() %>%
set_engine('lm') %>%
fit(y ~ x6, data = trn3)
MSE_df3_lm1 <- mean(pluck((predict(lm1_df3, tst3) - tst3$y)^2, 1))
MSE_df3_lm1
lm2_df3 <-
linear_reg() %>%
set_engine('lm') %>%
fit(y ~ x6 + x10, data = trn3)
MSE_df3_lm2 <- mean(pluck((predict(lm2_df3, tst3) - tst3$y)^2, 1))
MSE_df3_lm2
ggcorrplot(cor(trn3), lab = T, lab_size = 2)
pairs(~x6 + x10 + y, data = trn3)
trn3_outliers <- trn3 %>%
filter(y > 10)
View(trn3_outliers)
trn3 %>% filter(y > 10)
trn3 %>% arrange(y)
trn3 %>% arrange(desc(y))
trn3 %>% filter(y > 10)
trn3 %>% arrange(desc(y))
df3_train %>% filter(y > 10)
df3_train %>% filter(y > 10)
trn3_drop <- trn3 %>% filter(y < 7.4)
